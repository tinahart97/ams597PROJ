install.packages("devtools")
library("devtools")
devtools::install_github("klutometis/roxygen")
library(roxygen2)

setwd("parent_directory")
create("PoolMeta")

#' Fisher Test Meta Analysis
#'
#'This function uses the Fisher test to pool pvalues
#'It sums up the log-transformed p-values obtained from individual studies
#'It follows a χ2 distribution with 2 k degrees of freedom under the null hypothesis
#'
#' @param input is a list of p-values
#'
#' @return the Fisher pooled p-value as the test statistic
#'
#' @examples
#' set.seed(123)
#' p <- 100
#' data1 <- data.frame(group=sample(1:3,200,replace=TRUE),matrix(rnorm(p*200),ncol=p))
#' data2 <- data.frame(group=sample(1:2,150,replace=TRUE),matrix(rnorm(p*150),ncol=p))
#' data3 <- data.frame(group=sample(1:2,220,replace=TRUE),matrix(rnorm(p*220),ncol=p))

pool.fisher <- function(pvalues){
  k <- length(pvalues)
  df <- 2*k
  TS <- -2*sum(log(pvalues))
  p.value <- pchisq(TS, df=df,lower.tail=F)
  return(p.value)
}

setwd("./PoolMeta")
document()

setwd("..")
install("PoolMeta")

