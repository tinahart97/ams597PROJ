#'Stouffer Test Meta Analysis
#'
#'This function uses the Stouffer test to pool pvalues
#'It sums the inverse normal transformed p-values
#' follows a standard normal distribution under the null hypothesis 

#' @param input is a list of p-values

#' @return the Stouffer p-value as the test statistic
#'
#' @examples
#' set.seed(123)
#' p <- 100
#' data1 <- data.frame(group=sample(1:3,200,replace=TRUE),matrix(rnorm(p*200),ncol=p))
#' data2 <- data.frame(group=sample(1:2,150,replace=TRUE),matrix(rnorm(p*150),ncol=p))
#' data3 <- data.frame(group=sample(1:2,220,replace=TRUE),matrix(rnorm(p*220),ncol=p))

pool.stoeffer <- function(pvalues){
  k <- length(pvalues)
  TS <- sum(qnorm(pvalues)) / sqrt(k)
  p.value <- pnorm(TS, lower.tail=F)
  return(p.value)
}
